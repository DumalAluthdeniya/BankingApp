@model ManageCustomersViewModel

<p>Accounts of : @Model.Customer.FirstName</p>

<div><button id="AddAccount" data-cId="@Model.Customer.Id" class="btn btn-primary mb-2" @@click="active_tab = 6">+Create Account</button></div>
<table class="table">
	<thead class="thead-dark">
		<tr class="bg_primary text-white border">
			<th scope="col" style="padding:1rem;">Account Type</th>
			<th scope="col" style="padding:1rem;">Account No</th>
			<th scope="col" style="padding:1rem;">Account Balance</th>
			<th scope="col" style="padding:1rem;">Created Date</th>
			<th scope="col" style="padding:1rem;">Manage</th>
		</tr>
	</thead>
	<tbody>
		@if (Model.Accounts != null && Model.Accounts.Any())
		{
			@foreach (var a in Model.Accounts)
			{
				<tr class="border">
					<th style="padding:1rem;">@a.AccountType</th>
					<td style="padding:1rem;">@a.AccountNo</td>
					<td class="secondery__font fw-500" style="padding:1rem;"><b>@a.Balance.ToString("C", CultureInfo.CurrentCulture)</b></td>
					<td style="padding:1rem;">@a.CreatedDate.ToString("g",CultureInfo.CurrentCulture)</td>
					<td style="padding:1rem;"><a data-aId="@a.Id" @@click="active_tab = 5" style="border-radius: 4px;" class="bg_primary nav-item text-white text-center p-2 manageAccountDetails">Manage</a></td>
				</tr>
			}

		}
	</tbody>
</table>
<script>

	$("#AddAccount").click(function () {
		var cId = $(this).attr("data-cId");
		LoadAddAccount(cId);
	})

	function LoadAddAccount(cId) {
		$.ajax({
			type: "GET",
			async: true,
			url: '/BackOffice/Customers/LoadAddAccount',
			data: { "customerId": cId },
			success: function (data) {
				$('#createAccount').html(data);
			},
			error: function (error) {
				alert('Error occured. Please try again later.');
			}
		});
	}

	$(".manageAccountDetails").click(function () {
		var aId = $(this).attr("data-aId");
		LoadAccountTransactions(aId);
	})

	function LoadAccountTransactions(cId) {
		$.ajax({
			type: "GET",
			async: true,
			url: '/BackOffice/Customers/LoadAccountTransactions',
			data: { "accountId": cId },
			success: function (data) {
				$('#accountDetails').html(data);
			},
			error: function (error) {
				alert('Error occured. Please try again later.');
			}
		});
	}
</script>